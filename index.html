<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calcolatrice dei Dadi GdR</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
      
<style>
    
    .btn-outline-primary {
    --bs-btn-color: #338fc5;
    --bs-btn-border-color: #338fc5;
    --bs-btn-hover-color: #fff;
    --bs-btn-hover-bg: #338fc5;
    --bs-btn-hover-border-color: #338fc5;
    --bs-btn-focus-shadow-rgb: 13, 110, 253;
    --bs-btn-active-color: #fff;
    --bs-btn-active-bg: #338fc5;
    --bs-btn-active-border-color: #338fc5;
    --bs-btn-active-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
    --bs-btn-disabled-color: #338fc5;
    --bs-btn-disabled-bg: transparent;
    --bs-btn-disabled-border-color: #338fc5;
    --bs-gradient: none;
}
    .btn-success{
        background-color: #146c43;
    }
    .btn-danger{
        background-color: #bb2d3b;
    }
    .black{
        color: black;
    }
    .btn-custom
        {background-color: #338fc5;
           color: white;
            }
            .btn-custom:hover {
  background-color: #338fc5; 
  }
            .btn-custom:active {
  background-color: #356d8d !important; 
  }
</style>
</head>

<body class="d-flex justify-content-center" style="background-color: #c7a95c;">
    <div class="container m-md-5">
        <div class="calculator p-3 rounded shadow position-relative" style="background-color: #edede2;">

            <div class="row">
                <div class="col-9 p-0">
                    <input class="w-100 display border border-none bg-dark text-white p-3 rounded" id="display">
                </div>
                <div class="col-3 p-0">
                    <button class="btn bg-dark text-white w-100 h-100" onclick="event.stopPropagation(); rollDice()">
                        <h2 class="m-1">
                            <svg width="30px" viewBox="0 -2.5 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink">
                                <title>craps</title>
                                <desc>Created with Sketch.</desc>
                                <g id="icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <g id="ui-gambling-website-lined-icnos-casinoshunter"
                                        transform="translate(-990.000000, -542.000000)" fill="#FFFFFF"
                                        fill-rule="nonzero">
                                        <g id="square-filled" transform="translate(50.000000, 120.000000)">
                                            <path
                                                d="M961.998802,422.100461 L977.827723,426.337674 C979.390699,426.756064 980.318239,428.361044 979.899441,429.922496 L975.658094,445.735988 C975.239296,447.297441 973.63275,448.224076 972.069748,447.805679 L968.116396,446.746851 C967.901472,447.446596 967.431916,448.046113 966.780741,448.421703 L952.588919,456.607368 C951.187592,457.415636 949.395723,456.935974 948.586667,455.536014 L940.393015,441.358025 C939.583959,439.958065 940.064089,438.167942 941.465415,437.359675 L955.657237,429.174009 C956.109763,428.912998 956.61394,428.780409 957.132122,428.781544 L957.172177,428.782981 L958.410481,424.17016 C958.82928,422.608707 960.435825,421.682071 961.998802,422.100461 Z M956.676441,430.631194 L956.606676,430.662871 L956.538675,430.699217 L942.346853,438.884883 C941.825908,439.185357 941.624589,439.826504 941.862064,440.364013 L941.919711,440.477446 L950.113363,454.655434 C950.414131,455.175872 951.055903,455.376995 951.593937,455.139751 L951.70748,455.08216 L965.899303,446.896495 C966.099713,446.780901 966.256655,446.612376 966.357167,446.413556 L966.410598,446.290809 L960.954868,444.82956 C961.183921,445.518697 960.905749,446.296663 960.251644,446.673942 C959.503478,447.105475 958.546803,446.849384 958.114849,446.101947 C957.763267,445.493584 957.867672,444.74722 958.326227,444.255594 L958.429872,444.154288 L956.240853,443.568474 C954.733697,443.165026 953.8174,441.658232 954.129346,440.1512 L954.169093,439.983807 L954.537562,438.60552 C954.041259,438.556856 953.591345,438.274645 953.335218,437.831454 C952.903265,437.084018 953.159605,436.128274 953.907771,435.696742 C954.30391,435.468254 954.76823,435.42905 955.183804,435.567119 L955.337131,435.62718 L956.676441,430.631194 Z M954.910938,447.949923 L954.98006,448.083837 C955.311032,448.807986 955.042541,449.678487 954.338385,450.084636 C953.590219,450.516168 952.633543,450.260078 952.20159,449.512641 C951.769636,448.765205 952.025976,447.809462 952.774142,447.377929 C953.522308,446.946396 954.478984,447.202487 954.910938,447.949923 Z M966.847,446.202 L967.783,446.453 L967.783,446.452 L966.847,446.202 Z M952.521122,443.814677 L952.590244,443.948591 C952.921216,444.67274 952.652726,445.543241 951.94857,445.949389 C951.200404,446.380922 950.243728,446.124831 949.811774,445.377395 C949.379821,444.629958 949.636161,443.674215 950.384327,443.242682 C951.132493,442.81115 952.089169,443.06724 952.521122,443.814677 Z M960.152814,424.505049 L960.11329,424.625981 L955.871943,440.439472 C955.716254,441.019945 956.027701,441.61552 956.576069,441.82784 L956.697119,441.867326 L972.52604,446.104538 C973.107078,446.260075 973.703234,445.948931 973.915761,445.401098 L973.955286,445.280166 L978.196632,429.466675 C978.352321,428.886203 978.040874,428.290628 977.492506,428.078308 L977.371457,428.038822 L961.542536,423.80161 C960.961497,423.646073 960.365341,423.957216 960.152814,424.505049 Z M959.193,444.15 L959.19,444.152 L960.275,444.443 L960.273,444.44 L959.193,444.15 Z M950.131307,439.67943 L950.200429,439.813344 C950.531401,440.537493 950.26291,441.407994 949.558754,441.814143 C948.810589,442.245675 947.853913,441.989585 947.421959,441.242148 C946.990005,440.494712 947.246346,439.538968 947.994512,439.107436 C948.742677,438.675903 949.699353,438.931994 950.131307,439.67943 Z M969.74803,437.872203 C970.5825,438.095581 971.077712,438.952477 970.854116,439.786134 C970.630521,440.619791 969.772788,441.11452 968.938318,440.891142 C968.103847,440.667765 967.608636,439.810869 967.832231,438.977212 C968.055827,438.143554 968.913559,437.648825 969.74803,437.872203 Z M963.152646,436.106698 C963.987116,436.330076 964.482328,437.186972 964.258733,438.020629 C964.035137,438.854286 963.177405,439.349015 962.342934,439.125637 C961.508464,438.90226 961.013252,438.045364 961.236848,437.211706 C961.460443,436.378049 962.318175,435.88332 963.152646,436.106698 Z M971.411595,430.92679 C972.246065,431.150168 972.741277,432.007064 972.517682,432.840721 C972.294086,433.674378 971.436354,434.169107 970.601883,433.945729 C969.767413,433.722351 969.272201,432.865455 969.495797,432.031798 C969.719392,431.198141 970.577125,430.703412 971.411595,430.92679 Z M964.816211,429.161285 C965.650682,429.384663 966.145894,430.241559 965.922298,431.075216 C965.698702,431.908873 964.84097,432.403602 964.0065,432.180224 C963.172029,431.956846 962.676817,431.09995 962.900413,430.266293 C963.124009,429.432636 963.981741,428.937907 964.816211,429.161285 Z">
                                            </path>
                                        </g>
                                    </g>
                                </g>
                            </svg>

                        </h2>
                    </button>
                </div>
            </div>
            <div class="buttons row justify-content-center">
                <!-- Dice buttons -->
                <div class="row">
                    <button class="btn rounded-0 col-4" style="background-color:  #cce5f5;"
                        onclick="appendToDisplay('d4', true)">
                        <h2 class="m-1">d4</h2>
                    </button>
                    <button class="btn rounded-0 col-4" style="background-color: #b3d7ef;"
                        onclick="appendToDisplay('d6', true)">
                        <h2 class="m-1">d6</h2>
                    </button>
                    <button class="btn rounded-0 col-4" style="background-color: #99c9e8;"
                        onclick="appendToDisplay('d8', true)">
                        <h2 class="m-1">d8</h2>
                    </button>
                    <button class="btn rounded-0 col-4" style="background-color: #80bce1;"
                        onclick="appendToDisplay('d10', true)">
                        <h2 class="m-1">d10</h2>
                    </button>
                    <button class="btn rounded-0 col-4" style="background-color: #66add9;"
                        onclick="appendToDisplay('d12', true)">
                        <h2 class="m-1">d12</h2>
                    </button>
                    <button class="btn rounded-0 col-4" style="background-color: #4d9fcf;"
                        onclick="appendToDisplay('d100', true)">
                        <h2 class="m-1">d100</h2>
                    </button>
                    <button class="btn rounded-0 rounded-bottom-2 col-12" style="background-color: #338fc5;"
                        onclick="appendToDisplay('d20', true)">
                        <h1 class="m-1">d20</h1>
                    </button>
                </div>
                <!-- Numeric buttons -->
                <div class="row my-3 ">
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('1', false)">1</button>
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('2', false)">2</button>
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('4', false)">4</button>
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('3', false)">3</button>
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('5', false)">5</button>
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('6', false)">6</button>
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('7', false)">7</button>
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('8', false)">8</button>
                    <button class="btn btn-secondary border col-4" onclick="appendToDisplay('9', false)">9</button>
                    <button class="btn btn-secondary border col-8" onclick="appendToDisplay('0', false)">0</button>
                    <button class="btn btn-custom border col-4""
                        onclick="saveFormula()">❤</button>
                </div>
                <!-- Operation buttons -->
                <button class="btn btn-custom border col-4" onclick="appendToDisplay('+', false)">➕</button>
                <button class="btn btn-success border col-4" onclick="appendToDisplay('v', false)">
                    <h5 class="m-1"></h5>Vantaggio</h5>
                </button>
                <button class="btn btn-custom border col-4" onclick="backspaceDisplay()">
                    <h5 class="m-1 black">⌫</h5>
                </button>
                <button class="btn btn-custom border col-4" onclick="appendToDisplay('-', false)">➖</button>
                <button class="btn btn-danger border col-4" onclick="appendToDisplay('s', 'prova')">
                    <h5 class="m-1"></h5>Svantaggio</h5>
                </button>
                <button class="btn btn-custom border col-4" onclick="clearDisplay()"><span
                        class="p-1 bg-black border border-black rounded">🗑️</span></button>
                <!-- <button class="btn btn-success btn-lg col-12 mt-2" onclick="rollDice()">
                    <h1 class="m-1">Roll</h1>
                </button> -->
                <!-- Bottone per aprire il modale -->
                <button type="button" class="btn btn-secondary border col-4" data-bs-toggle="modal" data-bs-target="#statsModal">
                    Inserisci PG
                </button>
                <button type="button" class="btn btn-secondary border col-4" data-bs-toggle="modal" data-bs-target="#rollStatsModal">
                    Roll Stat
                </button>
                <button type="button" class="btn btn-secondary border col-4" data-bs-toggle="modal" onclick="loadStatforForce()" data-bs-target="#forceStatsModal">
                    Modifica Stat
                </button>
            </div>
        </div>


        <!-- Accordion for Saved Formulas and Roll History -->
        <div class="accordion mt-4" id="accordionExample">
            <!-- Formule Salvate -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingSavedFormulas">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseSavedFormulas" aria-expanded="true"
                        aria-controls="collapseSavedFormulas">
                        Formule Salvate
                    </button>
                </h2>
                <div id="collapseSavedFormulas" class="accordion-collapse collapse show"
                    aria-labelledby="headingSavedFormulas" data-bs-parent="#accordionExample">
                    <div class="accordion-body ">
                        <ul class="list-group " id="savedFormulas"></ul>
                    </div>
                </div>
            </div>

            <!-- Cronologia Tiri -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingRollHistory">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseRollHistory" aria-expanded="false" aria-controls="collapseRollHistory">
                        Cronologia Tiri
                    </button>
                </h2>
                <div id="collapseRollHistory" class="accordion-collapse collapse" aria-labelledby="headingRollHistory"
                    data-bs-parent="#accordionExample">
                    <div class="accordion-body">

                        <ul class="list-group" id="rollHistory"></ul>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <!-- Modale modifca formula -->
    <div class="modal" id="editModal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Modifica Formula</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <input type="text" class="form-control mb-2" id="editInputName" placeholder="Nuovo nome">
                    <input type="text" class="form-control" id="editInputFormula" placeholder="Formula">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="confirmEdit()">Ok</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                </div>
            </div>
        </div>
    </div>



  <!-- Modale Inserimento statistiche-->
<div class="modal fade" id="statsModal" tabindex="-1" aria-labelledby="statsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="statsModalLabel">Inserisci Statistiche D&D 5e</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="statsForm">
                    <div class="row">
                        <div class="col-4 form-floating mb-3">
                            <input type="number" value="1" class="form-control" id="level" min="1" max="20"
                                required>
                            <label for="level">Livello</label>
                        </div>
                        <div class="col-8 form-floating">
                            <input type="text" class="form-control" id="name" required>
                            <label for="name">Nome PG</label>
                        </div>
                        <p class="text-center">Caratteristica da Incantatore</p>
                        <div class="btn-group btn-group-sm mb-3" role="group">
                            <input type="radio" class="btn-check spellcasting" name="spellcasting" id="noSC" checked>
                            <label class="btn btn-outline-danger" for="noSC">N/A</label>
                            <input type="radio" class="btn-check spellcasting" name="spellcasting" id="intelligenceSC">
                            <label class="btn btn-outline-primary" for="intelligenceSC">INT</label>
                          
                            <input type="radio" class="btn-check spellcasting" name="spellcasting" id="wisdomSC">
                            <label class="btn btn-outline-primary" for="wisdomSC">SAG</label>
                          
                            <input type="radio" class="btn-check spellcasting" name="spellcasting" id="charismaSC">
                            <label class="btn btn-outline-primary" for="charismaSC">CAR</label>
                          </div>
                        <p class="text-center">Stat e Tiri salvezza</p>
                        <!-- Statistica FOR con tiro salvezza -->
                        <div class="col-4 mb-3">
                            <div class="row">
                                <div class="col-6 ps-3">FOR</div>
                                <div  class="col-6 text-end pe-4">TS</div>
                            </div>
                            <div class="input-group custom-group">
                                <input type="number" value="10" class="form-control" id="strength" min="1" max="20" required>
                                <div class="input-group-text">
                                    <input class="form-check-input saving-throw-checkbox" type="checkbox" value="FOR">
                                </div>
                            </div>
                        </div>

                        <!-- Statistica DEX con tiro salvezza -->
                        <div class="col-4 mb-3">
                            <div class="row">
                                <div class="col-6 ps-3">DEX</div>
                                <div  class="col-6 text-end pe-4">TS</div>
                            </div>
                            <div class="input-group custom-group">
                                <input type="number" value="10" class="form-control" id="dexterity" min="1" max="20" required>
                                <div class="input-group-text">
                                    <input class="form-check-input saving-throw-checkbox" type="checkbox" value="DEX">
                                </div>
                            </div>
                        </div>

                        <!-- Statistica COS con tiro salvezza -->
                        <div class="col-4 mb-3">
                            <div class="row">
                                <div class="col-6 ps-3">COS</div>
                                <div  class="col-6 text-end pe-4">TS</div>
                            </div>
                            <div class="input-group custom-group">
                                <input type="number" value="10" class="form-control" id="constitution" min="1" max="20" required>
                                <div class="input-group-text">
                                    <input class="form-check-input saving-throw-checkbox" type="checkbox" value="COS">
                                </div>
                            </div>
                        </div>

                        <!-- Statistica INT con tiro salvezza -->
                        <div class="col-4 mb-3">
                            <div class="row">
                                <div class="col-6 ps-3">INT</div>
                                <div  class="col-6 text-end pe-4">TS</div>
                            </div>
                            <div class="input-group custom-group">
                                <input type="number" value="10" class="form-control" id="intelligence" min="1" max="20" required>
                                <div class="input-group-text">
                                    <input class="form-check-input saving-throw-checkbox" type="checkbox" value="INT">
                                </div>
                            </div>
                        </div>

                        <!-- Statistica SAG con tiro salvezza -->
                        <div class="col-4 mb-3">
                            <div class="row">
                                <div class="col-6 ps-3">SAG</div>
                                <div  class="col-6 text-end pe-4">TS</div>
                            </div>
                            <div class="input-group custom-group">
                                <input type="number" value="10" class="form-control" id="wisdom" min="1" max="20" required>
                                <div class="input-group-text">
                                    <input class="form-check-input saving-throw-checkbox" type="checkbox" value="SAG">
                                </div>
                            </div>
                        </div>

                        <!-- Statistica CAR con tiro salvezza -->
                        <div class="col-4 mb-3">
                            <div class="row">
                                <div class="col-6 ps-3">CAR</div>
                                <div  class="col-6 text-end pe-4">TS</div>
                            </div>
                            <div class="input-group custom-group">
                                <input type="number" value="10" class="form-control" id="charisma" min="1" max="20" required>
                                <div class="input-group-text">
                                    <input class="form-check-input saving-throw-checkbox" type="checkbox" value="CAR">
                                </div>
                            </div>
                        </div>
                    </div>
                    <p class="text-center">Abilità</p>
                        <div class="row" id="skillsCheckboxes">
                            
                        </div>
                    </form>
                </div>
                <div class="modal-footer d-flex justify-content-center">
                    <button type="button" class="btn btn-custom" onclick="salvaStatistiche()">Salva</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modale Roll statistiche-->
    <div class="modal fade" id="rollStatsModal" tabindex="-1" aria-labelledby="statsModalLabel" aria-hidden="true">
        <div class="modal-dialog" >
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="statsModalLabel1"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    
                        <div class="row justify-content-center" id="rowRollCharModal">
                            <p>Inserisci prima le stat di un Personaggio!</p>
                        </div>
                    
                </div>
                
            </div>
        </div>
    </div>
    <!-- Modale forza statistiche-->
    <div class="modal fade" id="forceStatsModal" tabindex="-1" aria-labelledby="statsModalLabel" aria-hidden="true">
        <div class="modal-dialog" >
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="statsModalLabel1">Modifica Manuale</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    
                        <div class="row justify-content-center" id="rowforceCharModal">
                            
                        </div>
                    
                </div>
                <div class="modal-footer"></div>
                    <button type="button" class="btn btn-warning" onclick="saveModifiedStats()">Sovrascrivi</button>
                    
                </div>
                
            </div>
        </div>
    </div>

    <!-- Modale risultato dadi -->
<div class="modal fade " id="resultModal" tabindex="-1" aria-labelledby="resultModalLabel"
aria-hidden="true">
<div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" style="background-color: #c7a95c;" onclick="closeModal('resultModal')">
        <div class="modal-body">
            <!-- Il risultato e i dettagli del lancio verranno inseriti qui -->
            <div id="modalResultContent"></div>
        </div>
        <div class="modal-footer d-flex justify-content-evenly">
            <button type="button" class="btn btn-secondary"
                onclick="event.stopPropagation(); rollDice(true)">
                <h1 class="m-1">🔄</h1>
            </button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                <h1  class="m-1">❌</h1>
            </button>
        </div>
    </div>
</div>
</div>
    <!--  Script Bootstrap cdn -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <!--  Script personali -->
    <script src="script.js"></script>
    <script src="modalScript.js"></script>
    <script src="competenza.js"></script>
</body>

</html>